{
  "version": 2,
  "name": "kauri-serverless",
  "alias": [
    "kauri.io"
  ],
  "build": {
    "env": {
      "config": "production"
    }
  },
  "builds": [
    {
      "src": "app/static/**",
      "use": "@now/static"
    },
    {
      "src": "app/package.json",
      "use": "@now/next"
    },
    {
      "src": "api/*",
      "use": "@now/node"
    }
  ],
  "routes": [
    {
      "src": "/api/import/(.*)",
      "dest": "/api?url=$1"
    },
    {
      "src": "/robots.txt",
      "dest": "/app/static/development/robots.txt"
    },
    {
      "src": "/favicon.ico",
      "dest": "/app/static/favicon/favicon.ico"
    },
    {
      "src": "/(.*)/(.*)/l",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/view-link?id=$2"
    },
    {
      "src": "/article/(.*)/v(.*)/update-article",
      "dest": "/app/update-article?id=$1&version=$2"
    },
    {
      "src": "/(.*)/(.*)/a",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/article?article_id=$2&slug=$1"
    },
    {
      "src": "/article/(.*)/(.*)/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/article?article_id=$1"
    },
    {
      "src": "/article/(.*)/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/article?article_id=$1"
    },
    {
      "src": "/article/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/article?article_id=$1"
    },
    {
      "src": "/(.*)/(.*)/cm",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/community?community_id=$2&slug=$1"
    },
    {
      "src": "/community/(.*)/approve",
      "dest": "/app/approve?community_id=$1"
    },
    {
      "src": "/community/(.*)/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/community?community_id=$1"
    },
    {
      "src": "/community/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/community?community_id=$1"
    },
    {
      "src": "/(.*)/(.*)/c",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/collection?collection_id=$2&slug=$1"
    },
    {
      "src": "/collection/(.*)/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/collection?collection_id=$1"
    },
    {
      "src": "/collection/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/collection?collection_id=$1"
    },
    {
      "src": "/community/(.*)/update-community",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/update-community?community_id=$1"
    },
    {
      "src": "/collection/(.*)/update-collection",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/update-collection?collection_id=$1"
    },
    {
      "src": "/(.*)/p",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/public-profile?username=$1"
    },
    {
      "src": "/public-profile/(.*)",
      "headers": {"cache-control": "s-maxage=1, stale-while-revalidate"},
      "dest": "/app/public-profile?user_id=$1"
    },
    {
      "src": "/bookmarks",
      "dest": "/app/bookmarks"
    },
    {
      "src": "draft/(.*)/(.*)",
      "dest": "/app/draft?id=$1&version=$2"
    },
    {
      "src": "/activate/(.*)",
      "dest": "/app/activate?uuid=$1"
    },
    {
      "src": "/login",
      "dest": "/app/login"
    },
    {
      "src": "/(.*)",
      "dest": "/app/$1"
    },
    {
      "handle": "filesystem"
    },
    {
      "src": "/.*",
      "status": 404,
      "dest": "/app/404"
    },
    {
      "src": "/.*",
      "status": 500,
      "dest": "/app/500"
    }
  ]
}
